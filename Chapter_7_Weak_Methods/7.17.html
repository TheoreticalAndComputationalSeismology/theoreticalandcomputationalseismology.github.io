
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Problem 7.17 &#8212; Theoretical &amp; Computational Seismology: Solutions</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Chapter_7_Weak_Methods/7.17';</script>
    <link rel="icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Problem 7.18" href="7.18.html" />
    <link rel="prev" title="Problem 7.16" href="7.16.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Theoretical & Computational Seismology: Solutions - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Theoretical & Computational Seismology: Solutions - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Theoretical & Computational Seismology
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Continuum Mechanics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Chapter_1_Kinematics/1.00.html">1 Kinematics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter_2_Dynamics/2.00.html">2 Dynamics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Seismology</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Chapter_4_Linearized_EoM/4.00.html">4 Linearized Equations of Motion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter_5_Anelasticity_Attenuation/5.00.html">5 Anelasticity and Attenuation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Forward Problems</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter_6_Strong_Methods/6.00.html">6 Strong Methods</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_6_Strong_Methods/6.01.html">Problem 6.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_6_Strong_Methods/6.02.html">Problem 6.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_6_Strong_Methods/6.03.html">Problem 6.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_6_Strong_Methods/6.04.html">Problem 6.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_6_Strong_Methods/6.05.html">Problem 6.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_6_Strong_Methods/6.06.html">Problem 6.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_6_Strong_Methods/6.07.html">Problem 6.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_6_Strong_Methods/6.08.html">Problem 6.8</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_6_Strong_Methods/6.09.html">Problem 6.9</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_6_Strong_Methods/6.10.html">Problem 6.10</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_6_Strong_Methods/6.11.html">Problem 6.11</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_6_Strong_Methods/6.12.html">Problem 6.12</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_6_Strong_Methods/6.13.html">Problem 6.13</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_6_Strong_Methods/6.14.html">Problem 6.14</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="7.00.html">7 Weak Methods</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="7.01.html">Problem 7.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="7.02.html">Problem 7.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="7.03.html">Problem 7.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="7.04.html">Problem 7.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="7.05.html">Problem 7.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="7.06.html">Problem 7.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="7.07.html">Problem 7.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="7.08.html">Problem 7.8</a></li>
<li class="toctree-l2"><a class="reference internal" href="7.09.html">Problem 7.9</a></li>
<li class="toctree-l2"><a class="reference internal" href="7.10.html">Problem 7.10</a></li>
<li class="toctree-l2"><a class="reference internal" href="7.11.html">Problem 7.11</a></li>
<li class="toctree-l2"><a class="reference internal" href="7.12.html">Problem 7.12</a></li>
<li class="toctree-l2"><a class="reference internal" href="7.13.html">Problem 7.13</a></li>
<li class="toctree-l2"><a class="reference internal" href="7.14.html">Problem 7.14</a></li>
<li class="toctree-l2"><a class="reference internal" href="7.15.html">Problem 7.15</a></li>
<li class="toctree-l2"><a class="reference internal" href="7.16.html">Problem 7.16</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Problem 7.17</a></li>
<li class="toctree-l2"><a class="reference internal" href="7.18.html">Problem 7.18</a></li>
<li class="toctree-l2"><a class="reference internal" href="7.19.html">Problem 7.19</a></li>
<li class="toctree-l2"><a class="reference internal" href="7.20.html">Problem 7.20</a></li>
<li class="toctree-l2"><a class="reference internal" href="7.21.html">Problem 7.21</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/TheoreticalAndComputationalSeismology/theoreticalandcomputationalseismology.github.io" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/TheoreticalAndComputationalSeismology/theoreticalandcomputationalseismology.github.io/issues/new?title=Issue%20on%20page%20%2FChapter_7_Weak_Methods/7.17.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Chapter_7_Weak_Methods/7.17.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Problem 7.17</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-the-code">Setting up the code:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-our-roots">Checking our roots</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="problem-7-17">
<h1>Problem 7.17<a class="headerlink" href="#problem-7-17" title="Link to this heading">#</a></h1>
<p>There are a number of ways one can obtain the solutions of the equation</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
(1 - \xi^2 ) \frac{\mathrm{d}}{\mathrm{d}\xi} P_n(\xi) = 0 
\end{equation*}\]</div>
<p>for which <span class="math notranslate nohighlight">\(P_n\)</span> is the Legendre polynomial of degree <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>Numerous algorithms have been developed for finding the roots of functions. In this case, we will use a simple <a class="reference external" href="https://en.wikipedia.org/wiki/Bisection_method">Bisection method</a>. This requires us to be able to evaluate</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
f(\xi) = (1 - \xi^2 ) \frac{\mathrm{d}}{\mathrm{d}\xi} P_n(\xi) 
\end{equation*}\]</div>
<p>within the domain <span class="math notranslate nohighlight">\(\xi \in [-1,\,+1]\)</span>. To do this, we can utilise one of the many identities of the Legendre polynomials,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
(1 - \xi^2 ) \frac{\mathrm{d}}{\mathrm{d}\xi} P_n(\xi) = n \left[  P_{n-1}(\xi) -  x P_n(\xi) \right]; 
\end{equation*} \]</div>
<p>see <a class="reference external" href="https://dlmf.nist.gov/14.10">Relation 14.10.5 of DLFM</a>. This allows us to write our function <span class="math notranslate nohighlight">\(f(\xi)\)</span> in terms of Legendre polynomials, which are available in SciPy.</p>
<section id="setting-up-the-code">
<h2>Setting up the code:<a class="headerlink" href="#setting-up-the-code" title="Link to this heading">#</a></h2>
<p>First let us define a few parameters. <span class="math notranslate nohighlight">\(n\)</span> is the order of the Legendre polynomial in our function. There will then be <span class="math notranslate nohighlight">\(n+1\)</span> roots including the end points <span class="math notranslate nohighlight">\(\xi = \pm 1\)</span>. In the case that <span class="math notranslate nohighlight">\(n\)</span> is even, one of the roots will be <span class="math notranslate nohighlight">\(\xi=0\)</span>. Note that the roots are always symmetric about <span class="math notranslate nohighlight">\(\xi=0\)</span>. We will seek out roots by splitting up the domain into a number of segments and testing if a root lies within that segment. The number of segments is given by <code class="docutils literal notranslate"><span class="pre">Nsegs</span></code>. When this number is high, computation time is longer. When this number is too low, you risk missing roots or not converging.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ss</span> 
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span> 
<span class="kn">from</span><span class="w"> </span><span class="nn">copy</span><span class="w"> </span><span class="kn">import</span> <span class="n">copy</span> 
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span> 


<span class="n">n</span>      <span class="o">=</span> <span class="mi">11</span>                 <span class="c1"># Degree of Legendre polynomial</span>
<span class="n">Nsegs</span>  <span class="o">=</span> <span class="mi">100</span>                <span class="c1"># Number of segments</span>
<span class="n">nroots</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>              <span class="c1"># Number of roots</span>
<span class="n">roots</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nroots</span><span class="p">)</span>   <span class="c1"># Array to hold all the roots</span>

<span class="c1"># Compute relevant Legendre functions</span>
<span class="c1"># leg_n and leg_n_1 are orthopoly1d objects that can be called to </span>
<span class="c1"># return a value of the polynomial at (a) specific xi value(s)</span>
<span class="n">leg_n</span>   <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">legendre</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>    <span class="c1"># P_n  </span>
<span class="n">leg_n_1</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">legendre</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># P_{n-1}</span>


<span class="c1"># Let us also define a function that returns our function f</span>
<span class="c1"># at point(s) xi </span>
<span class="c1"># Note here that we parse in leg_n and leg_n_1</span>
<span class="c1"># as arguments so they are only generated once above, </span>
<span class="c1"># instead of being initialised every time the function is computed</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_functional</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">lnm1</span><span class="p">,</span> <span class="n">ln</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">lnm1</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span> <span class="o">-</span> <span class="n">xi</span> <span class="o">*</span> <span class="n">ln</span><span class="p">(</span><span class="n">xi</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Since we know two of the roots are <span class="math notranslate nohighlight">\(\xi = \pm 1\)</span>, lets set those now:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Two roots will always be +=1</span>
<span class="n">roots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>   <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">roots</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="o">=</span>  <span class="mi">1</span>
<span class="c1"># Count the number of roots found so far </span>
<span class="n">nrts_found</span> <span class="o">=</span>  <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p>Note here that if <span class="math notranslate nohighlight">\(n \le 2\)</span> then we are done, since the roots are at <span class="math notranslate nohighlight">\(\xi = \pm 1\)</span> or <span class="math notranslate nohighlight">\(\xi = 0\)</span>. Hence we only need to execute the next cells if there are more roots to be found. To do this, we will use the Bisection method. Since the roots are symmetric about 0, we only need to seek roots in the range <span class="math notranslate nohighlight">\(\xi = [0, 1]\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For n &lt;= 2 we are done already...</span>
<span class="k">if</span> <span class="n">nroots</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
    
    <span class="c1"># End point to search for root</span>
    <span class="c1"># -- avoiding xi = 1</span>
    <span class="n">xi_end</span> <span class="o">=</span> <span class="mf">0.99999</span>

    <span class="k">if</span> <span class="n">n</span><span class="o">%</span><span class="k">2</span>==0:
        <span class="c1"># Even power n</span>
        <span class="c1"># Odd number of roots including xi = 0</span>
        <span class="c1"># can start hunting only from &gt; 0 and &lt; 1</span>
        <span class="n">xi_start</span> <span class="o">=</span> <span class="mf">0.00001</span>
        <span class="n">nrts_found</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Look for the positive roots (mirror around xi = 0)</span>
        <span class="n">xi_start</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="c1"># Create array of segments </span>
    <span class="n">segments</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xi_start</span><span class="p">,</span> <span class="n">xi_end</span><span class="p">,</span> <span class="n">Nsegs</span><span class="p">)</span>
    
    <span class="c1"># Evaluate function at each segment boundary</span>
    <span class="n">fseg</span> <span class="o">=</span> <span class="n">compute_functional</span><span class="p">(</span><span class="n">segments</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">leg_n_1</span><span class="p">,</span> <span class="n">leg_n</span><span class="p">)</span>

    <span class="c1"># Index in the &#39;roots&#39; array to store the root</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nroots</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">nroots</span><span class="o">%</span><span class="k">2</span> 

    <span class="c1"># Loop through each segment and test if root lies within</span>
    <span class="k">for</span> <span class="n">iseg</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nsegs</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="c1"># Deal with the unlikely cases we hit </span>
        <span class="c1"># the root position exactly</span>
        <span class="k">if</span> <span class="n">fseg</span><span class="p">[</span><span class="n">iseg</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Root found exactly here</span>
            <span class="n">error</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">nrts_found</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">fseg</span><span class="p">[</span><span class="n">iseg</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Root found exactly here</span>
            <span class="n">error</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">nrts_found</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1"># More likely - check if a root is within the segment</span>
        <span class="c1"># indicated by change in sign of the function values at </span>
        <span class="c1"># each end of the segment</span>
        <span class="k">elif</span> <span class="n">fseg</span><span class="p">[</span><span class="n">iseg</span><span class="p">]</span> <span class="o">*</span> <span class="n">fseg</span><span class="p">[</span><span class="n">iseg</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># There is a change in sign between the two values:</span>
            <span class="c1"># Start with the current edge xi positions of the &#39;segment&#39;</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">segments</span><span class="p">[</span><span class="n">iseg</span><span class="p">]</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">segments</span><span class="p">[</span><span class="n">iseg</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

            <span class="c1"># initialise with a high error</span>
            <span class="n">error</span> <span class="o">=</span> <span class="mi">999</span>
            
            <span class="c1"># We iterate until the function value at the midpoint (&#39;error&#39;)</span>
            <span class="c1"># is close to 0</span>
            <span class="k">while</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-9</span><span class="p">:</span>

                <span class="c1"># See if function has local positive or negative gradient</span>
                <span class="n">grad</span> <span class="o">=</span>  <span class="n">compute_functional</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">leg_n_1</span><span class="p">,</span> <span class="n">leg_n</span><span class="p">)</span> \
                      <span class="o">-</span> <span class="n">compute_functional</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">leg_n_1</span><span class="p">,</span> <span class="n">leg_n</span><span class="p">)</span>
                
                <span class="c1"># Get midpoint and function value at midpoint</span>
                <span class="n">this_root</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
                <span class="n">error</span>    <span class="o">=</span>  <span class="n">compute_functional</span><span class="p">(</span><span class="n">this_root</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">leg_n_1</span><span class="p">,</span> <span class="n">leg_n</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">error</span> <span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># if sign of gradient * sign of error </span>
                    <span class="c1"># (functional value at midpoint) is &gt; 0 </span>
                    <span class="c1"># then we replace</span>
                    <span class="c1"># upper bound else replace the lower bound</span>
                    <span class="k">if</span> <span class="n">grad</span><span class="o">*</span><span class="n">error</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">b</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">this_root</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">a</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">this_root</span><span class="p">)</span>

            <span class="c1"># Add newest root found and update index</span>
            <span class="n">roots</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_root</span>
            <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="c1"># Adding 2 to account for symmetry</span>
            <span class="n">nrts_found</span><span class="o">+=</span><span class="mi">2</span>


    <span class="c1"># Now we have scanned for all the roots within [0, 1]</span>
    <span class="c1"># Mirror roots around 0 since symmetric:</span>
    <span class="c1"># The n%2 accounts for the difference in mirroring (due to the 0 root) for n being</span>
    <span class="c1"># odd or even</span>
    <span class="k">for</span> <span class="n">irt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">n</span><span class="o">%</span><span class="k">2</span>):
        <span class="n">i1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nroots</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span><span class="n">irt</span>
        <span class="n">i2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nroots</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span><span class="n">irt</span>  <span class="o">-</span> <span class="n">n</span><span class="o">%</span><span class="k">2</span> 
        <span class="n">roots</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">roots</span><span class="p">[</span><span class="n">i2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="checking-our-roots">
<h2>Checking our roots<a class="headerlink" href="#checking-our-roots" title="Link to this heading">#</a></h2>
<p>We should now have all the roots, but lets check that:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">nrts_found</span> <span class="o">!=</span> <span class="n">nroots</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: found </span><span class="si">{</span><span class="n">nrts_found</span><span class="si">}</span><span class="s2"> but there are </span><span class="si">{</span><span class="n">nroots</span><span class="si">}</span><span class="s2">. Try larger Nsegs.&quot;</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of roots found: </span><span class="si">{</span><span class="n">nrts_found</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">nroots</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Roots                :</span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">roots</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">compute_functional</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">leg_n_1</span><span class="p">,</span> <span class="n">leg_n</span><span class="p">),</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">roots</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nroots</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of roots found: 12/12
Roots                :
 [-1.         -0.94489927 -0.81927932 -0.63287615 -0.39953094 -0.13655293
  0.13655293  0.39953094  0.63287615  0.81927932  0.94489927  1.        ]
</pre></div>
</div>
<img alt="../_images/bbb2326c3c4c945adb2bd3162faaa65ce5b2c7c6f15b7c2184534b0cc06bbf3a.png" src="../_images/bbb2326c3c4c945adb2bd3162faaa65ce5b2c7c6f15b7c2184534b0cc06bbf3a.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Chapter_7_Weak_Methods"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="7.16.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Problem 7.16</p>
      </div>
    </a>
    <a class="right-next"
       href="7.18.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Problem 7.18</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-the-code">Setting up the code:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-our-roots">Checking our roots</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jeroen Tromp et al.
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>